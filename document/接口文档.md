## 返回 json格式统一说明

包含以下属性

```java
T data			//T为泛型的类型标记
String msg      //返回的信息（错误原因等）
int ResultCode	//状态码，现在定义了四种，如下
```

ResultCode取值情况如下

```java
public interface ResultCode {
    int success=1;
    int fail=2;
    int exception=3;
    int abnormal=4;
}
```



## 接口

### 域名

**47.93.218.244**

### 基本震情接口

##### 1、上传基本震情的json文件

类型：get

URL：/disasterUpload

参数：file

参数类型：MultipartFile

返回：

```json
success情况
{
    "msg": "success",
    "data": "none",
    "ResultCode": 1
}
```

```json
abnormal情况
{
    "msg": "no file",
    "data": "none",
    "ResultCode": 4
}
```

```json
exception情况
{
    "msg": "json data is out of standard",
    "data": "none",
    "ResultCode": 3
}
```

##### 2、拿到全部的disaster，带搜索，分页

类型：get

URL：/getDisaster

参数：

```java
String key
Integer page
Integer limit
```

返回：

```json
{
    "code": 0,				//状态码
    "msg": "",				//信息，基本用不到
    "count": 5,				//总共查询到的个数
    "data": [				//下面是当前页的数据
        {
            "id": 154,
            "unifiedId": "501",
            "province": "安徽",
            "city": "马鞍山",
            "country": "当涂县",
            "town": "",
            "village": "",
            "date": "2020-07-03 12:54:21",
            "location": "安徽马鞍山当涂县",
            "longitude": 10.0,
            "latitude": 20.0,
            "depth": 1.0,
            "magnitude": 2.0,
            "picture": "/disaster/154.jpg",			//这个图片可以通过 【域名+picture显示】
            "reportingUnit": null,
            "did": "34052100000020200703125421"
        }
    ]
}
```

##### 3、根据ID删除disaster

类型：delete

URL：/deleteDisasterInfoById

参数：

```java
int id			//基本震情的ID
```

返回：

```json
{				//失败
    "msg": "the id doesn't exist",
    "data": "none",
    "ResultCode": 4
}
```

```json
{				//成功
    "msg": "delete success",
    "data": "none",
    "ResultCode": 1
}
```

##### 4、根据ID修改disaster

类型：get

URL：/updateDisasterInfoById

参数：

```java
int id,
String province,
String city,
String country,
String town,
String village,
String date,
double longitude,
double latitude,
float depth,
float magnitude,
String reportingUnit,
MultipartFile file    			//需要修改图片的话
```

返回：

/updateDisasterInfoById?id=154&province=安徽&city=马鞍山&country=当涂县&town=姑孰镇&village=&date=2020-04-03 12:54:21&longitude=10&latitude=20&depth=1&magnitude=2&reportingUnit=当涂地震局

```json
{
    "msg": "update success",
    "data": "none",
    "ResultCode": 1
}
```

/updateDisasterInfoById?id=154&province=安徽省&city=马鞍山&country=当涂县&town=姑孰镇&village=&date=2020-04-03 12:54:21&longitude=10&latitude=20&depth=1&magnitude=2&reportingUnit=当涂地震局

```json
{
    "msg": "the location or date is invalid",
    "data": "none",
    "ResultCode": 4
}
```

##### 5、添加新的disaster

类型：get

URL：/addDisasterInfo

参数：

```java
MultipartFile file,			//图片文件同时上传，前端检查一下文件大小
String province,
String city,
String country,
String town,
String village,
String date,
double longitude,
double latitude,
float depth,
float magnitude,
String reportingUnit
```

返回：（body里面还有multipartfile）

/addDisasterInfo?province=安徽&city=马鞍山&country=当涂县&town=&village=&date=2020-07-03 12:54:21&longitude=10&latitude=20&depth=1&magnitude=2& reportingUnit=当涂地震局

```json
{
    "msg": "add success",
    "data": {
        "id": 142					//插入数据的ID号
    },
    "ResultCode": 1
}
```

/addDisasterInfo?province=安徽省&city=马鞍山&country=当涂县&town=&village=&date=2020-07-03 12:54:21&longitude=10&latitude=20&depth=1&magnitude=2& reportingUnit=当涂地震局

```json
{
    "msg": "the location or date is invalid",
    "data": "none",
    "ResultCode": 4
}
```

##### 6、从FTP服务器读取基本灾情数据

类型：get

URL：/ftpConfig

参数：

```java
String ip
String user
String passwd
```

返回：

成功

```json
{
    "msg": "connect success, and insert success",
    "data": "0",
    "ResultCode": 1
}
```

失败

```json
{
    "msg": "connect fail (please check the ip,username,password)",
    "data": "none",
    "ResultCode": 4
}
```

##### 7、基本灾情的地图数据

类型：get

URL：/MapData

参数：

```java
String startDate
String endDate
```

返回：

成功	/MapData?startDate=2020-04-01 12:00:00&endDate=2021-05-01 12:00:00

```json
{
    "msg": "success",
    "data": {
        "coordinate": {
            "北京东城区": [
                40.16,
                116.63
            ],
            "安徽马鞍山当涂县姑孰镇": [
                20.0,
                10.0
            ],
            "山西省长治市潞州区": [
                35.5,
                113.01
            ]
        },
        "info": [
            {
                "depth": 1.0,
                "latitude": 20.0,
                "name": "安徽马鞍山当涂县姑孰镇",
                "magnitude": 2.0,
                "value": 392,
                "longitude": 10.0
            },
            {
                "depth": 15.0,
                "latitude": 40.16,
                "name": "北京东城区",
                "magnitude": 7.0,
                "value": 9,
                "longitude": 116.63
            },
            {
                "depth": 10.0,
                "latitude": 35.5,
                "name": "山西省长治市潞州区",
                "magnitude": 5.5,
                "value": 7,
                "longitude": 113.01
            }
        ]
    },
    "ResultCode": 1
}
```

失败	/MapData?startDate="2020-04-01 12:00:00"&endDate=2021-05-01 12:00:00

```json
{
    "msg": "Timestamp format must be yyyy-mm-dd hh:mm:ss[.fffffffff]",
    "data": "none",
    "ResultCode": 4
}
```

